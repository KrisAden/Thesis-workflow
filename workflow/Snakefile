# workflow/Snakefile
import os, sys
from pathlib import Path
from snakemake.shell import shell

ROOT = Path.cwd()
SRC  = ROOT / "src"
PYTHON = sys.executable

if os.name == "nt":
    shell.executable("powershell")
    RUN_CMD = f'& "{PYTHON}" -m pypsa_thesis.preprocess --config "{ROOT / "config/config.yaml"}"'
else:
    shell.executable("/bin/bash")
    RUN_CMD = f'PYTHONPATH="{SRC}" "{PYTHON}" -m pypsa_thesis.preprocess --config "{ROOT / "config/config.yaml"}"'

rule all:
    input:
        "data/interim/network_rescaled.nc",
        "results/tables/load_scaling.csv"

rule rescale_loads:
    output:
        "data/interim/network_rescaled.nc",
        "results/tables/load_scaling.csv"
    shell:
        RUN_CMD
